<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TikTok Downloader - T·∫£i Video Kh√¥ng Watermark</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 10px;
            font-size: 2.5em;
        }

        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
            font-size: 1.1em;
        }

        .input-section {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 30px;
        }

        .input-group {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        input[type="text"] {
            flex: 1;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 10px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        input[type="text"]:focus {
            outline: none;
            border-color: #667eea;
        }

        button {
            padding: 15px 30px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
        }

        button:active {
            transform: translateY(0);
        }

        button:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        .url-list {
            margin-top: 15px;
        }

        .url-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px;
            background: white;
            border-radius: 8px;
            margin-bottom: 10px;
            border: 1px solid #e0e0e0;
        }

        .url-text {
            flex: 1;
            color: #333;
            font-size: 14px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .remove-btn {
            padding: 5px 15px;
            background: #ff4757;
            font-size: 14px;
        }

        .info-box {
            background: #e3f2fd;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            border-left: 4px solid #2196f3;
        }

        .info-box p {
            color: #1976d2;
            margin-bottom: 5px;
        }

        .results {
            margin-top: 30px;
        }

        .video-card {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid #e0e0e0;
        }

        .video-info {
            margin-bottom: 15px;
        }

        .video-info h3 {
            color: #333;
            margin-bottom: 10px;
        }

        .video-meta {
            color: #666;
            font-size: 14px;
            margin-bottom: 5px;
        }

        .video-preview {
            width: 100%;
            max-width: 300px;
            border-radius: 10px;
            margin: 15px 0;
        }

        .download-btn {
            width: 100%;
            background: linear-gradient(135deg, #00d2ff 0%, #3a7bd5 100%);
            margin-top: 10px;
        }

        .status {
            padding: 8px 15px;
            border-radius: 5px;
            font-size: 14px;
            margin-top: 10px;
            display: inline-block;
        }

        .status.loading {
            background: #fff3cd;
            color: #856404;
        }

        .status.success {
            background: #d4edda;
            color: #155724;
        }

        .status.error {
            background: #f8d7da;
            color: #721c24;
        }

        .loading-spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #667eea;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .progress-container {
            margin-top: 20px;
        }

        .progress-item {
            padding: 10px;
            background: #f0f0f0;
            border-radius: 8px;
            margin-bottom: 10px;
        }

        .progress-bar {
            width: 100%;
            height: 20px;
            background: #e0e0e0;
            border-radius: 10px;
            overflow: hidden;
            margin-top: 5px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            transition: width 0.3s;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üéµ TikTok Downloader</h1>
        <p class="subtitle">T·∫£i video TikTok kh√¥ng c√≥ watermark - H·ªó tr·ª£ t·∫£i nhi·ªÅu video c√πng l√∫c</p>

        <div class="info-box">
            <p><strong>üìù H∆∞·ªõng d·∫´n s·ª≠ d·ª•ng:</strong></p>
            <p>1. Sao ch√©p link video TikTok t·ª´ ·ª©ng d·ª•ng (nh·∫•n "Chia s·∫ª" ‚Üí "Sao ch√©p li√™n k·∫øt")</p>
            <p>2. D√°n link v√†o √¥ b√™n d∆∞·ªõi v√† nh·∫•n "Th√™m v√†o danh s√°ch"</p>
            <p>3. Th√™m nhi·ªÅu link n·∫øu mu·ªën t·∫£i nhi·ªÅu video c√πng l√∫c</p>
            <p>4. Nh·∫•n "T·∫£i t·∫•t c·∫£ video" ƒë·ªÉ b·∫Øt ƒë·∫ßu</p>
        </div>

        <div class="input-section">
            <div class="input-group">
                <input type="text" id="urlInput" placeholder="D√°n link TikTok v√†o ƒë√¢y (vd: https://www.tiktok.com/@user/video/...)">
                <button onclick="addUrl()">Th√™m v√†o danh s√°ch</button>
            </div>
            
            <div id="urlList" class="url-list"></div>

            <button id="downloadAllBtn" onclick="downloadAll()" style="width: 100%; margin-top: 15px;" disabled>
                T·∫£i t·∫•t c·∫£ video (<span id="urlCount">0</span>)
            </button>
        </div>

        <div id="progressContainer" class="progress-container" style="display: none;"></div>
        <div id="results" class="results"></div>
    </div>

    <script>
        let urlList = [];

        function addUrl() {
            const input = document.getElementById('urlInput');
            const url = input.value.trim();

            if (!url) {
                alert('Vui l√≤ng nh·∫≠p link TikTok!');
                return;
            }

            if (!url.includes('tiktok.com')) {
                alert('Link kh√¥ng h·ª£p l·ªá! Vui l√≤ng nh·∫≠p link TikTok.');
                return;
            }

            if (urlList.includes(url)) {
                alert('Link n√†y ƒë√£ ƒë∆∞·ª£c th√™m v√†o danh s√°ch!');
                return;
            }

            urlList.push(url);
            input.value = '';
            updateUrlList();
        }

        function removeUrl(index) {
            urlList.splice(index, 1);
            updateUrlList();
        }

        function updateUrlList() {
            const container = document.getElementById('urlList');
            const countSpan = document.getElementById('urlCount');
            const downloadBtn = document.getElementById('downloadAllBtn');

            countSpan.textContent = urlList.length;
            downloadBtn.disabled = urlList.length === 0;

            if (urlList.length === 0) {
                container.innerHTML = '';
                return;
            }

            container.innerHTML = urlList.map((url, index) => `
                <div class="url-item">
                    <span class="url-text">${url}</span>
                    <button class="remove-btn" onclick="removeUrl(${index})">X√≥a</button>
                </div>
            `).join('');
        }

        async function downloadAll() {
            if (urlList.length === 0) return;

            const resultsDiv = document.getElementById('results');
            const progressContainer = document.getElementById('progressContainer');
            const downloadBtn = document.getElementById('downloadAllBtn');

            resultsDiv.innerHTML = '';
            progressContainer.style.display = 'block';
            progressContainer.innerHTML = '';
            downloadBtn.disabled = true;

            for (let i = 0; i < urlList.length; i++) {
                const url = urlList[i];
                const progressId = `progress-${i}`;
                
                progressContainer.innerHTML += `
                    <div class="progress-item" id="${progressId}">
                        <div>Video ${i + 1}/${urlList.length}</div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 0%"></div>
                        </div>
                        <div class="status loading">ƒêang x·ª≠ l√Ω...</div>
                    </div>
                `;

                await downloadVideo(url, i, progressId);
            }

            downloadBtn.disabled = false;
        }

        async function downloadVideo(url, index, progressId) {
            const progressItem = document.getElementById(progressId);
            const progressFill = progressItem.querySelector('.progress-fill');
            const statusDiv = progressItem.querySelector('.status');

            try {
                progressFill.style.width = '30%';
                statusDiv.textContent = 'ƒêang l·∫•y th√¥ng tin video...';

                // API ƒë·ªÉ t·∫£i video TikTok kh√¥ng watermark
                const apiUrl = `https://www.tikwm.com/api/?url=${encodeURIComponent(url)}`;
                
                progressFill.style.width = '60%';
                const response = await fetch(apiUrl);
                const data = await response.json();

                if (data.code !== 0 || !data.data) {
                    throw new Error('Kh√¥ng th·ªÉ l·∫•y th√¥ng tin video');
                }

                progressFill.style.width = '100%';
                statusDiv.className = 'status success';
                statusDiv.textContent = 'Ho√†n th√†nh!';

                displayVideoResult(data.data, index);

            } catch (error) {
                console.error('Error:', error);
                progressFill.style.width = '100%';
                statusDiv.className = 'status error';
                statusDiv.textContent = 'L·ªói: ' + error.message;

                const resultsDiv = document.getElementById('results');
                resultsDiv.innerHTML += `
                    <div class="video-card">
                        <div class="status error">
                            ‚ùå Kh√¥ng th·ªÉ t·∫£i video ${index + 1}: ${error.message}
                        </div>
                    </div>
                `;
            }
        }

        function displayVideoResult(videoData, index) {
            const resultsDiv = document.getElementById('results');
            
            const videoCard = document.createElement('div');
            videoCard.className = 'video-card';
            videoCard.innerHTML = `
                <div class="video-info">
                    <h3>Video ${index + 1}: ${videoData.title || 'Kh√¥ng c√≥ ti√™u ƒë·ªÅ'}</h3>
                    <div class="video-meta">üë§ T√°c gi·∫£: ${videoData.author?.nickname || 'N/A'} (@${videoData.author?.unique_id || 'N/A'})</div>
                    <div class="video-meta">‚ù§Ô∏è L∆∞·ª£t th√≠ch: ${formatNumber(videoData.digg_count || 0)}</div>
                    <div class="video-meta">üí¨ B√¨nh lu·∫≠n: ${formatNumber(videoData.comment_count || 0)}</div>
                    <div class="video-meta">üîÑ Chia s·∫ª: ${formatNumber(videoData.share_count || 0)}</div>
                    <div class="video-meta">‚ñ∂Ô∏è L∆∞·ª£t xem: ${formatNumber(videoData.play_count || 0)}</div>
                    <div class="video-meta">‚è±Ô∏è Th·ªùi l∆∞·ª£ng: ${videoData.duration || 0}s</div>
                </div>
                ${videoData.cover ? `<img src="${videoData.cover}" class="video-preview" alt="Video preview">` : ''}
                <button class="download-btn" onclick="window.open('${videoData.play}', '_blank')">
                    ‚¨áÔ∏è T·∫£i video (Kh√¥ng Watermark)
                </button>
                ${videoData.music ? `
                    <button class="download-btn" onclick="window.open('${videoData.music}', '_blank')">
                        üéµ T·∫£i nh·∫°c n·ªÅn
                    </button>
                ` : ''}
            `;

            resultsDiv.appendChild(videoCard);
        }

        function formatNumber(num) {
            if (num >= 1000000) {
                return (num / 1000000).toFixed(1) + 'M';
            } else if (num >= 1000) {
                return (num / 1000).toFixed(1) + 'K';
            }
            return num.toString();
        }

        // Cho ph√©p nh·∫•n Enter ƒë·ªÉ th√™m URL
        document.getElementById('urlInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                addUrl();
            }
        });
    </script>
</body>
</html>
